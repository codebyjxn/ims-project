# Backend Scripts Documentation

This directory contains utility scripts for managing the Concert Booking System backend.

## Main Scripts (Available via npm run)

### 🔧 `create-admin.ts`
**Command:** `npm run create-admin`

Creates the admin user in the appropriate database (PostgreSQL or MongoDB based on migration status).

**Credentials:**
- **Email:** `admin@concert.com`
- **Password:** `admin123`

**Usage:**
```bash
# Create admin user in current database
npm run create-admin

# Or run inside Docker container
docker-compose -f docker-compose.dev.yml exec backend npm run create-admin
```

### 🌱 `seed-data.ts`
**Command:** `npm run seed`

Seeds the PostgreSQL database with sample data:
- 50 regular users (password: `password123`)
- 40 fans with referral codes and preferences
- 10 organizers with organizations
- 20 artists across various genres
- 10 arenas with different capacities
- 30 concerts with pricing and tickets

**Note:** Admin user must be created separately using `create-admin` script.

### 🔄 `migrate-data.ts`
**Command:** `npm run migrate`

Migrates data from PostgreSQL to MongoDB, transforming relational data into document format.

## Development/Testing Scripts

### 📊 `test-dual-database.ts`
Tests the dual database functionality by switching between PostgreSQL and MongoDB modes.

**Run manually:**
```bash
ts-node src/scripts/test-dual-database.ts
```

### 🔐 `test-auth-dual-db.ts`
Tests authentication functionality across both databases.

**Run manually:**
```bash
ts-node src/scripts/test-auth-dual-db.ts
```

## Recommended Workflow

1. **Start with clean databases:**
   ```bash
   # Clear all data (preserves admin user)
   curl -X DELETE http://localhost:4000/api/admin/clear \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

2. **Create admin user:**
   ```bash
   npm run create-admin
   ```

3. **Seed sample data:**
   ```bash
   npm run seed
   ```

4. **Optional - Migrate to MongoDB:**
   ```bash
   npm run migrate
   ```

## Database Credentials

### Admin User
- **Email:** `admin@concert.com`
- **Password:** `admin123`

### Sample Users (created by seed script)
- **Password:** `password123` (for all seeded users)
- **Emails:** Generated by Faker.js

## Important Notes

- Admin user is **preserved** when clearing databases via the admin endpoint
- All passwords are properly hashed using bcrypt
- Scripts automatically detect which database to use based on migration status
- Use the admin panel UI for easier database management 